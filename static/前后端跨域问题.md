---
link: https://blog.csdn.net/xwyzsn/article/details/114700474
title: spring vue 打包后的跨域请求资源（跨域preflight）问题
description: spring vue 打包后的跨域请求资源（跨域preflight）问题问题描述最近刚学习前后端的知识,就简单的做了一个前后端分离的项目.当在vue中使用axios或者fetch等去获取spring的API接口的时候会报跨域错误即 CORS 跨域资源共享错误简单地说 我的vue 运行在http://localhost:8080端口上 而spring 运行在http://localhost:8085端口上由于这两个端口不同所以在请求的时候视为跨域,这个时候就无法简单的通过请求获得。解决方案1.ngi
keywords: spring vue 打包后的跨域请求资源（跨域preflight）问题
author: Xwyzsn Csdn认证博客专家 Csdn认证企业博客 码龄2年 暂无认证
date: 2021-03-12T08:55:00.000Z
publisher: null
catalog:blog
stats: paragraph=26 sentences=11, words=155
---
# spring vue 打包后的跨域请求资源（跨域preflight）问题

## 问题描述

最近刚学习前后端的知识,就简单的做了一个前后端分离的项目.当在vue中使用axios或者fetch等去获取spring的API接口的时候会报跨域错误即 **CORS 跨域资源共享错误**

简单地说 我的vue 运行在http://localhost:8080端口上 而spring 运行在http://localhost:8085端口上由于这两个端口不同所以在请求的时候视为跨域,这个时候就无法简单的通过请求获得。

## 解决方案

### 1.nginx

使用nginx代理，nginx反向代理原理如下

![](https://img-blog.csdnimg.cn/img_convert/e76d0f8ba0d3229c48d3d9af7690a359.png)

即我们客户端想要访问真正的后端的时候实际上是访问代理服务器，由代理服务器去转发到服务器去取回我们需要的数据。

由此，下载nginx在nginx.conf文件中输入自己要代理的数据。

```
    server {
        listen       8888;# &#x670D;&#x52A1;&#x5668;&#x76D1;&#x542C;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x524D;&#x7AEF;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;
        server_name  localhost;
        location / {
            root   html;
            index  index.html index.htm;
        }

    location /api/ {//&#x76D1;&#x542C;&#x7684;&#x8DEF;&#x5F84;&#x4FE1;&#x606F;
	     	proxy_pass http://<后端的ip或者域名>:<端口>;//&#x76D1;&#x542C;&#x5230;&#x4E0A;&#x8FF0;&#x7684;&#x8DEF;&#x5F84;&#x540E;&#x5C06;&#x8F6C;&#x53D1;&#x5230;&#x8FD9;&#x4E2A;&#x4EE3;&#x7406;&#x4E0A;&#x53BB;
		    add_header Access-Control-Allow-Origin *;
            add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
            add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-		             Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-              Control,Content-           Type,Authorization,token';
    }
}
</端口></后端的ip或者域名>
```

让后启动nginx服务即可，此后把前端中应该访问地址 改为

### 2.在后端中配置

因为后端使用spring，所以可以在controller层中添加一个annotation

```java
@CrossOrigin(origins = "")

```

这个annotation可以在每个mapping中进行使用也可以对整个controller层进行使用。

### preflight错误

在完成上述以后，get方法能够正常的使用而post方法不能正常使用，报了一个preflight错误，这个错误的原因是当我们的请求不是一个简单请求的使用，会先发一个询问信息，在发送post请求，如果我们直接发data过去服务器就会发生这个错误使用axios发送的默认是 **application/json**不是一个简单的请求，所以我们可以把他转为简单请求 **Content-Type: application/x-www-form-urlencoded**

#### 如何解决

在vue项目中axios加上头信息 **Content-Type: application/x-www-form-urlencoded**然后使用qs.stringfy({这里是json格式的数据})把数据转化为如下信息，即可进行post，此时spring中![](https://img-blog.csdnimg.cn/img_convert/739b54d87e4e3993cde42cf933dc888f.png)

同时spring中相关的controller

```java
    @PostMapping(consumes = "application/x-www-form-urlencoded")
    public  void postToDb( Study study) throws Exception {
        studyService.postToDb(study);
    }
```

如上即可正常的post了
