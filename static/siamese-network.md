---
title:siamese network
date:2021-03-17 20.30.51
catalog:paper
---
# siamese network
## 什么是孪生网络。
Siamese network,又称孪生网络，其网络结构为由两个网络组成，而这两个网络又通过共享其间的权值而联系起来。Siamese network 提出是在1993年yann lecun等人的论文Signature Verification using a ‘Siamese’ Time Delay Neural Network中提出的，其工作原理是通过对于比较网络的输入来比较输入的相似度，同理预测即是输出两个输入的相似度，现今其多用于图像的识别等。网络结构如下。![image-20210317195842086](https://gitee.com/xwyzsn/Picture/raw/master/image-20210317195842086.png)

可以看出，当进行训练的时候，模型接受两个输入，并且给出两个输入的相似度标签0为不相关，1为相关，两个网络的权值是相同的，最后得到两个输出，得到两个输出后计算其loss的值。再进行梯度下降等方法调整权值，不断的训练后得到最终收敛的权值。训练完之后的模型能够由给定的两个输入进行预测判断其相似度。其中其相似度计算公式可以为欧式距离，即$d=||f_1(x_1)-f_2(x_2)||_2$

使用两个输入的L2范数是为了避免对于模型不同的输入顺序而得到不同的结果。即如$(x_1,x_2)$和$(x_2,x_1)$都应当视为统一输入。为了使用梯度下降对于权重进行更新，需要定义一个损失函数，在逻辑回归中我们对于二分类的损失函数通常定义如下。$L=(1-y(x_1,x_2)_i)log(1-d_i)+y(x_1,x_2)log\ d_i$，这是对于二分类通常定义的损失函数。在yann lecun的文章中提出了一种适用于Siamese网络的新的损失函数$L=\sum^{N}_{n=1} y(x_1,x_2)*d_i^2 + *(1-y(x_1,x_2)_i * max(m-d_i),0)^2$这个损失函数的目标是当输入的两个输入

$x_1,和x_2$若两个输入相似，则y=1,此时其损失只有前面的部分决定即$y(x_1,x_2)*d_i$，若两个输入是不相似的，那么y=0此时，模型的损失由后半部分决定，即$(1-y(x_1,x_2))*max(m-d_i，0)$其中m是设定的一个margin，后半部分的意思是，如果两个输入原本是不相似则距离d应该很大，这个时候使用m-d刚好就达到了我们需要的效果，使得如果两个输入不相似，而此时d小，损失值就大。（yann lecun 永远滴神）



